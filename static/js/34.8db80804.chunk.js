(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[34],{1063:function(e,n,t){"use strict";t.r(n);var a=t(3),o=t(9),i=t(36),c=(t(825),t(0)),l=t.n(c),r=t(47),u=t(1061),d=t(12),s=t(702),h=Object(r.o)((function(e){var n,t=e.shiftData,a=e.isInput,o=e.setIsInput,i=Object(s.b)((function(e){return e.thucDonDuTru})).tongHopOfShifts,c=t.id,r=(null===i||void 0===i||null===(n=i[c])||void 0===n?void 0:n.tongPhanAn)||0,u=t.id===a.shiftId;return l.a.createElement("div",{className:"display-4 mt-1 kind-title"},"".concat(t.name," - ").concat(Object(d.b)(r)," ph\u1ea7n"),l.a.createElement("button",{className:["btn btn-sm ml-1 mb-1",u?"btn-warning":"btn-outline-warning"].join(" "),onClick:function(){o(u?{}:{shiftId:t.id,type:"soPhanAn"})}},u?"\u0110\xf3ng":"M\u1edf"," c\u1eadp nh\u1eadt ",null===t||void 0===t?void 0:t.name))})),v=t(923),m=function(e){var n=e.rowDatas.reduce((function(e,n){var t=((null===e||void 0===e?void 0:e.thanhTien)||0)+((null===n||void 0===n?void 0:n.thanhTien)||0);return Object(a.a)(Object(a.a)({},e),{},{soPhanAn:((null===e||void 0===e?void 0:e.soPhanAn)||0)+((null===n||void 0===n?void 0:n.soPhanAn)||0),soPhanThem:((null===e||void 0===e?void 0:e.soPhanThem)||0)+((null===n||void 0===n?void 0:n.soPhanThem)||0),thanhTien:Math.round(t)})}),{});return l.a.createElement(u.a.Summary.Row,null,l.a.createElement(u.a.Summary.Cell,{colSpan:6},l.a.createElement("div",{className:"text-center text-small font-weight-bold text-dark"},"T\u1ed5ng")),l.a.createElement(u.a.Summary.Cell,{colSpan:1},l.a.createElement("div",{className:"font-weight-bold  text-small text-danger float-right"},Object(d.a)(n.thanhTien))),l.a.createElement(u.a.Summary.Cell,{colSpan:1}))},b={soMonMan:"S\u1ed1 m\xf3n m\u1eb7n",soMonChay:"S\u1ed1 m\xf3n chay",soMonCT:"S\u1ed1 m\xf3n CT",soMonNuoc:"S\u1ed1 m\xf3n n\u01b0\u1edbc",tongPhan:"T\u1ed5ng ph\u1ea7n"},f=function(e){var n,t=e.dayTongHopData,a=e.shiftId,r=Object(s.b)((function(e){return e.thucDonDuTru})).tongHopOfShifts,h=Object(s.b)((function(e){return e.thucDonDuTruSetting})).nhomGiaMonAnData,v=(null===r||void 0===r||null===(n=r[a])||void 0===n?void 0:n.tongPhanAn)||0,m=(null===t||void 0===t?void 0:t.tongPhan)||0,f=(null===h||void 0===h?void 0:h.giaPhanAn)||0,g=v*f,p=Object(c.useState)([]),O=Object(i.a)(p,2),j=O[0],C=O[1];Object(c.useEffect)((function(){var e=[];t&&(e=(e=["soMonMan","soMonChay","soMonCT","soMonNuoc","tongPhan"].reduce((function(e,n){var a=(null===t||void 0===t?void 0:t[n])||0,i=a*f,c={loaiMon:n,soPhan:a,cost:Math.round(i/g*100*10)/10};return[].concat(Object(o.a)(e),[c])}),[])).filter((function(e){return e.soPhan>0}))),C(e)}),[t,r]);var D=[{dataIndex:"loaiMon",title:"Lo\u1ea1i m\xf3n",width:110,className:" text-small",render:function(e,n){return"tongPhan"===n.loaiMon?l.a.createElement("div",{className:"font-weight-bold"},(null===b||void 0===b?void 0:b[e])||""):(null===b||void 0===b?void 0:b[e])||""}},{dataIndex:"soPhan",title:"S\u1ed1 ph\u1ea7n",className:" text-small",render:function(e,n){return"tongPhan"===n.loaiMon?l.a.createElement("div",{className:"float-right font-weight-bold"},Object(d.a)(e)):l.a.createElement("div",{className:"float-right"},Object(d.a)(e))},width:70},{dataIndex:"cost",title:"Cost",width:60,className:" text-small",render:function(e,n){return"tongPhan"===n.loaiMon?l.a.createElement("small",{className:"float-right font-weight-bold"},v-m):l.a.createElement("small",{className:"float-right text-danger font-weight-bold"},e,"%")}}];return l.a.createElement("div",null,l.a.createElement("div",{className:"font-weight-bold text-center text-danger mb-2"},"T\u1ed5ng h\u1ee3p s\u1ed1 ph\u1ea7n"),l.a.createElement(u.a,{rowKey:"loaiMon",columns:D,dataSource:j,pagination:!1,scroll:{x:240}}))},g=t(806),p=t(285),O=t(301),j={chiPhiCoDinh:"CP c\u1ed1 \u0111\u1ecbnh",chiPhiNguyenVatLieu:"CP NVL",tongChiPhi:"T\u1ed5ng CP",doanhThu:"Doanh Thu"},C=Object(r.o)((function(e){var n=e.history,t=e.dayTongHopData,o=e.dataSource,c=e.shiftData,r=c.id,h=Object(s.b)((function(e){return e.thucDonDuTru})).tongHopOfShifts,v=Object(s.b)((function(e){return e.thucDonDuTruSetting})).nhomGiaMonAnData,m=l.a.useState([]),b=Object(i.a)(m,2),f=b[0],C=b[1],D=l.a.useState(0),y=Object(i.a)(D,2),M=y[0],E=y[1],T=l.a.useState(0),P=Object(i.a)(T,2),I=P[0],N=P[1];l.a.useEffect((function(){var e,n=I+M,t=((null===v||void 0===v?void 0:v.giaPhanAn)||0)*((null===h||void 0===h||null===(e=h[r])||void 0===e?void 0:e.tongPhanAn)||0),a=[{loaiChiPhi:"chiPhiCoDinh",tien:M||"",cost:n&&M?Math.round(M/n*100*100)/100:""},{loaiChiPhi:"chiPhiNguyenVatLieu",tien:I||"",cost:I&&n?Math.round(I/n*100*100)/100:""},{loaiChiPhi:"tongChiPhi",tien:n||"",cost:n&&t?Math.round(n/t*100*100)/100:""},{loaiChiPhi:"doanhThu",tien:t||"",cost:""}];C(a)}),[M,I,v,t,h,r]),l.a.useEffect((function(){if(v&&t){var e=(null===t||void 0===t?void 0:t.tongPhan)||0,n=Object(p.b)(v,{tongPhan:e});E(n)}}),[v,t]),l.a.useEffect((function(){var e=o.reduce((function(e,n){var t=((null===e||void 0===e?void 0:e.thanhTien)||0)+((null===n||void 0===n?void 0:n.thanhTien)||0);return Object(a.a)(Object(a.a)({},e),{},{thanhTien:Math.round(t)})}),{});N((null===e||void 0===e?void 0:e.thanhTien)||0)}),[o,h]);var S=[{dataIndex:"loaiChiPhi",title:"Lo\u1ea1i CP",width:120,className:" text-small",render:function(e){switch(e){case"chiPhiCoDinh":return l.a.createElement("div",{style:{textDecoration:"underline",color:"blue"},className:"hoverClass",onClick:function(){var e=[[g.b.MODAL_ID,g.a.openChiPhiCoDinhModal.id],[g.b.SHIFT_ID,c.id]];Object(O.d)(n,e)}},(null===j||void 0===j?void 0:j[e])||"");case"tongChiPhi":case"doanhThu":return l.a.createElement("div",{className:"font-weight-bold"},null===j||void 0===j?void 0:j[e]);default:return l.a.createElement("div",null,(null===j||void 0===j?void 0:j[e])||"")}}},{dataIndex:"tien",title:"Ti\u1ec1n",className:" text-small",render:function(e,n){return"tongChiPhi"===n.loaiChiPhi||"doanhThu"===n.loaiChiPhi?l.a.createElement("div",{className:"float-right font-weight-bold"},Object(d.a)(e)):l.a.createElement("div",{className:"float-right"},Object(d.a)(e))},width:70},{dataIndex:"cost",title:"Cost",width:60,className:" text-small",render:function(e){return e&&l.a.createElement("sub",{className:"text-danger font-weight-bold"},e,"%")}}];return l.a.createElement("div",{className:"mt-2"},l.a.createElement("div",{className:"font-weight-bold text-center text-danger mb-2"},"T\u1ed5ng h\u1ee3p chi ph\xed"),l.a.createElement(u.a,{rowKey:"loaiChiPhi",columns:S,dataSource:f,pagination:!1,scroll:{x:250}}))})),D=t(146),y=t(707),M=t(4),E=t(10),T=t(16),P=t(7),I=t.n(P),N=t(187),S=t(175),x=t(85),w=t(89),A=t(6);function L(e){return void 0!==e&&null!==e}var k=function(e){var n,t=e.itemPrefixCls,a=e.component,o=e.span,i=e.className,l=e.style,r=e.labelStyle,u=e.contentStyle,d=e.bordered,s=e.label,h=e.content,v=e.colon,m=a;return d?c.createElement(m,{className:I()((n={},Object(M.a)(n,"".concat(t,"-item-label"),L(s)),Object(M.a)(n,"".concat(t,"-item-content"),L(h)),n),i),style:l,colSpan:o},L(s)&&c.createElement("span",{style:r},s),L(h)&&c.createElement("span",{style:u},h)):c.createElement(m,{className:I()("".concat(t,"-item"),i),style:l,colSpan:o},c.createElement("div",{className:"".concat(t,"-item-container")},s&&c.createElement("span",{className:I()("".concat(t,"-item-label"),Object(M.a)({},"".concat(t,"-item-no-colon"),!v)),style:r},s),h&&c.createElement("span",{className:I()("".concat(t,"-item-content")),style:u},h)))};function _(e,n,t){var a=n.colon,o=n.prefixCls,i=n.bordered,l=t.component,r=t.type,u=t.showLabel,d=t.showContent,s=t.labelStyle,h=t.contentStyle;return e.map((function(e,n){var t=e.props,v=t.label,m=t.children,b=t.prefixCls,f=void 0===b?o:b,g=t.className,p=t.style,O=t.labelStyle,j=t.contentStyle,C=t.span,D=void 0===C?1:C,y=e.key;return"string"===typeof l?c.createElement(k,{key:"".concat(r,"-").concat(y||n),className:g,style:p,labelStyle:Object(A.a)(Object(A.a)({},s),O),contentStyle:Object(A.a)(Object(A.a)({},h),j),span:D,colon:a,component:l,itemPrefixCls:f,bordered:i,label:u?v:null,content:d?m:null}):[c.createElement(k,{key:"label-".concat(y||n),className:g,style:Object(A.a)(Object(A.a)(Object(A.a)({},s),p),O),span:1,colon:a,component:l[0],itemPrefixCls:f,bordered:i,label:v}),c.createElement(k,{key:"content-".concat(y||n),className:g,style:Object(A.a)(Object(A.a)(Object(A.a)({},h),p),j),span:2*D-1,component:l[1],itemPrefixCls:f,bordered:i,content:m})]}))}var H=function(e){var n=c.useContext(U),t=e.prefixCls,a=e.vertical,o=e.row,i=e.index,l=e.bordered;return a?c.createElement(c.Fragment,null,c.createElement("tr",{key:"label-".concat(i),className:"".concat(t,"-row")},_(o,e,Object(A.a)({component:"th",type:"label",showLabel:!0},n))),c.createElement("tr",{key:"content-".concat(i),className:"".concat(t,"-row")},_(o,e,Object(A.a)({component:"td",type:"content",showContent:!0},n)))):c.createElement("tr",{key:i,className:"".concat(t,"-row")},_(o,e,Object(A.a)({component:l?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},n)))},G=function(e){return e.children},R=t(43),U=c.createContext({}),K={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function V(e,n,t){var a=e;return(void 0===n||n>t)&&(a=Object(R.a)(e,{span:t}),Object(x.a)(void 0===n,"Descriptions","Sum of column `span` in a line not match `column` of Descriptions.")),a}function F(e){var n,t=e.prefixCls,a=e.title,o=e.extra,i=e.column,l=void 0===i?K:i,r=e.colon,u=void 0===r||r,d=e.bordered,s=e.layout,h=e.children,v=e.className,m=e.style,b=e.size,f=e.labelStyle,g=e.contentStyle,p=c.useContext(w.b),O=p.getPrefixCls,j=p.direction,C=O("descriptions",t),D=c.useState({}),y=Object(E.a)(D,2),P=y[0],x=y[1],A=function(e,n){if("number"===typeof e)return e;if("object"===Object(T.a)(e))for(var t=0;t<S.b.length;t++){var a=S.b[t];if(n[a]&&void 0!==e[a])return e[a]||K[a]}return 3}(l,P);c.useEffect((function(){var e=S.a.subscribe((function(e){"object"===Object(T.a)(l)&&x(e)}));return function(){S.a.unsubscribe(e)}}),[]);var L=function(e,n){var t=Object(N.a)(e).filter((function(e){return e})),a=[],o=[],i=n;return t.forEach((function(e,c){var l,r=null===(l=e.props)||void 0===l?void 0:l.span,u=r||1;if(c===t.length-1)return o.push(V(e,r,i)),void a.push(o);u<i?(i-=u,o.push(e)):(o.push(V(e,u,i)),a.push(o),i=n,o=[])})),a}(h,A),k=c.useMemo((function(){return{labelStyle:f,contentStyle:g}}),[f,g]);return c.createElement(U.Provider,{value:k},c.createElement("div",{className:I()(C,(n={},Object(M.a)(n,"".concat(C,"-").concat(b),b&&"default"!==b),Object(M.a)(n,"".concat(C,"-bordered"),!!d),Object(M.a)(n,"".concat(C,"-rtl"),"rtl"===j),n),v),style:m},(a||o)&&c.createElement("div",{className:"".concat(C,"-header")},a&&c.createElement("div",{className:"".concat(C,"-title")},a),o&&c.createElement("div",{className:"".concat(C,"-extra")},o)),c.createElement("div",{className:"".concat(C,"-view")},c.createElement("table",null,c.createElement("tbody",null,L.map((function(e,n){return c.createElement(H,{key:n,index:n,colon:u,prefixCls:C,vertical:"vertical"===s,bordered:d,row:e})})))))))}F.Item=G;var z=F,X=t(697),J=t(698),q=t(232),B=z.Item,Q=Object(r.o)((function(e){var n,t=e.history,a=e.location,o=e.dayTongHopData,r=e.shiftData,u=Object(O.c)(a,g.b.MODAL_ID),h=Object(O.c)(a,g.b.SHIFT_ID),v=Object(s.b)((function(e){return e.thucDonDuTruSetting})).nhomGiaMonAnData,m=Object(s.b)((function(e){return e.diaDiem})).diaDiemData,b=null===m||void 0===m?void 0:m.id,f=Object(c.useState)(!1),p=Object(i.a)(f,2),j=p[0],C=p[1];Object(c.useEffect)((function(){var e=u===g.a.openChiPhiCoDinhModal.id&&"".concat(r.id)==="".concat(h);C(!!e)}),[u,r]);var M=(null===o||void 0===o?void 0:o.tongPhan)||0,E=(null===o||void 0===o?void 0:o.chiPhiCoDinh)||0,T=((null===o||void 0===o?void 0:o.soMonMan)||0)+((null===o||void 0===o?void 0:o.soMonChay)||0);return l.a.createElement(y.a,{title:l.a.createElement("div",{className:"text-dark"},l.a.createElement("i",{className:"fa fa-sliders mr-2"}),l.a.createElement("strong",null,g.a.openChiPhiCoDinhModal.name," - ",null===D.c||void 0===D.c||null===(n=D.c[b])||void 0===n?void 0:n.name)),isOpen:j,onCancel:function(){return t.push("?")},centered:!0,footer:!1,width:"650px"},l.a.createElement("div",{className:"mb-3"},l.a.createElement("strong",null,"T\u1ed5ng ph\u1ea7n: ",Object(d.a)(M),", T\u1ed5ng ph\u1ea7n c\u01a1m: ",Object(d.a)(T)," - Chi ph\xed c\u1ed1 \u0111\u1ecbnh: ",Object(d.a)(E))),l.a.createElement(z,{bordered:!0,column:1,size:"small"},q.b.map((function(e){var n=(null===v||void 0===v?void 0:v[e.id])||0,t="".concat(e.name," = ").concat(Object(d.a)(n)," x ").concat(Object(d.a)(M)," ph\u1ea7n"),a=M*n;if("gao"===e.id){var o=n,i=(null===v||void 0===v?void 0:v.dinhLuongGao)||0,c=Math.round(i/100)/10;a=(n*=c)*T,t="Gi\xe1 ".concat(e.name," x \u0110L g\u1ea1o = ").concat(Object(d.a)(o)," x ").concat(c," x ").concat(Object(d.a)(T)," ph\u1ea7n")}var r=Object(d.k)(a,E);return l.a.createElement(B,{key:e.id,label:t,span:1},l.a.createElement(X.a,{gutter:5},l.a.createElement(J.a,{span:12,className:"font-weight-bold"},l.a.createElement("div",{className:"float-right"},Object(d.a)(a))),l.a.createElement(J.a,{span:12},l.a.createElement("small",{className:"text-danger font-weight-bold"},"(",r,"%)"))))}))))})),W=t(153),Y=t(286),Z=t(305),$=t(289),ee=t(329);var ne=function(e){var n=e.record,t=Object(s.b)((function(e){return e.nguyenLieu})).nguyenLieus,a=Object(s.b)((function(e){return e.recipe})).ingreRecipeData,i=l.a.useMemo((function(){var e=null===n||void 0===n?void 0:n.tenMon;return((null===a||void 0===a?void 0:a[e])||[]).reduce((function(a,i){var c,l=i.id,r=(null===t||void 0===t?void 0:t[l])||{},u=r.tenNguyenLieu,d=r.tenNhaCungCap,s=r.giaNguyenLieu,h=void 0===s?0:s,v=i.dinhLuong||0,m=(n.soPhanAn||0)+(n.soPhanThem||0),b=(null===n||void 0===n?void 0:n.dieuChinh)||{},f=(null===b||void 0===b||null===(c=b[e])||void 0===c?void 0:c[l])||0,g=(v+f)*m/1e3,p=Math.round(g*h),O={id:i.id,tenNguyenLieu:u,dinhLuong:v,dieuChinh:f,tongDinhLuong:g,tongGia:p,tenNhaCungCap:d,giaNguyenLieu:h};return[].concat(Object(o.a)(a),[O])}),[])}),[n,a,t]),c=l.a.useMemo((function(){return(new ee.a).getChiTietThanhPhanColumns()}),[]);return l.a.createElement("div",{style:{width:"100%"},className:"ingreExpandexItem"},l.a.createElement(u.a,{rowKey:"id",bordered:!0,size:"small",className:"mb-2",columns:c,dataSource:i,pagination:!1}))},te=t(17),ae=t(39),oe=t(826);function ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;return function(a,o){var i=t.shiftId,c=t.soMonMan,l=o(),r=l.recipe.recipes,u=l.diaDiem.dayId,d=l.thucDonDuTruSetting,s=d.cauHinhDuTrus,h=d.nhomGiaMonAnData,v=null===s||void 0===s?void 0:s[i],m=l.thucDonDuTru,b=null===m||void 0===m?void 0:m["thucDonDatas/".concat(i)],f={dayDuTruData:e,dayId:u,dayThucDonData:b,recipeDatas:r,soMonMan:c},g=oe.a.getSoTongPhan(v,f),O=Object(p.b)(h,{tongPhan:g}),j=n.reduce((function(e,n){return e+(n.chiPhiNVL||0)}),0),C=O+j;return{soMonMan:oe.a.getSoMonMan(v,f),soMonMan_CoCanh:oe.a.getSoMonMan_CoCanh(v,f),soMonNuocChay:oe.a.getSoMonNuocChay(v,f),soMonCT_CoCom:oe.a.getSoMonCT_CoCom(v,f),soMonChay:oe.a.getSoMonChay(v,f),soMonCT:oe.a.getSoMonCT(v,f),soMonNuoc:oe.a.getSoMonNuoc(v,f),soMonCanh:oe.a.getSoMonCanh(v,f),soMonXao:oe.a.getSoMonXao(v,f),soMonTrangMieng:oe.a.getSoMonTrangMieng(v,f),tongPhan:g,chiPhiCoDinh:O,chiPhiNVL:j,tongChiPhi:C}}}function ce(e,n,t){return function(i,c){var l,r,u,d=c(),s=t.shiftId,h=t.soMonMan,v=d.diaDiem,m=v.diaDiemData,b=v.customerId,f=v.yearId,g=v.weekId,p=v.dayId,O=null===m||void 0===m?void 0:m.id,j=d.thucDonDuTru,C=null===j||void 0===j?void 0:j["duTruDatas/".concat(s)],D=null===n||void 0===n?void 0:n.recipeKindId,y=null===n||void 0===n?void 0:n.type,M=[O,f,g,"shiftIds",s,"customerIds",b,p,"kindIds",D,y],E=null===C||void 0===C||null===(l=C[D])||void 0===l?void 0:l[y];switch(y){case"ghiChu":E=E||"";break;case"soPhanAn":case"soPhanThem":E=E||0;break;case"dieuChinh":var T=null===n||void 0===n?void 0:n.nguyenLieuId,P=null===n||void 0===n?void 0:n.recipeId;M=[].concat(Object(o.a)(M),[P,T]),E=(null===(r=E)||void 0===r||null===(u=r[P])||void 0===u?void 0:u[T])||0}var I=!Object(ae.isEqual)(E,e),N=function(){};if(D&&y&&I)switch(y){case"soPhanAn":case"soPhanThem":var S=Object(a.a)({},C),x=(null===S||void 0===S?void 0:S.ghiChu)||null;x||(x=""),Object(ae.set)(S,[D,y],e);var w=i(ie(S,[],{shiftId:s,soMonMan:h})),A=i(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return function(t,o){var i=n.shiftId,c=o(),l=c.thucDonDuTruSetting.cauHinhDuTrus,r=null===l||void 0===l?void 0:l[i],u=c.thucDonDuTru,d=null===u||void 0===u?void 0:u["duTruDatas/".concat(i)],s=(null===e||void 0===e?void 0:e.soMonCanh)||0,h=(null===e||void 0===e?void 0:e.soMonMan_CoCanh)||0,v=(null===e||void 0===e?void 0:e.soMonNuocChay)||0,m=(null===e||void 0===e?void 0:e.soMonCT_CoCom)||0,b=(null===e||void 0===e?void 0:e.soMonXao)||0,f=(null===e||void 0===e?void 0:e.soMonTrangMieng)||0,g=s-h-v+m,p=b-v;return[{id:W.b.monCanhConfig.id,soPhanAn:g===1/0?0:g},{id:W.b.monXaoConfig.id,soPhanAn:p===1/0?0:p},{id:W.b.dessertConfig.id,soPhanAn:f===1/0?0:f}].reduce((function(e,n){var t,o,i=null===(t=r[n.id])||void 0===t||null===(o=t.values)||void 0===o?void 0:o[0],c=(null===d||void 0===d?void 0:d[i])||{},l=(null===c||void 0===c?void 0:c.ghiChu)||null;l||(l="");var u=Object(a.a)(Object(a.a)({},c),{},{ghiChu:l,soPhanAn:n.soPhanAn});return Object(a.a)(Object(a.a)({},e),{},Object(te.a)({},i,u))}),{})}}(w,{shiftId:s})),L=null===S||void 0===S?void 0:S[D],k=Object(a.a)(Object(a.a)({},A),{},Object(te.a)({},D,Object(a.a)({ghiChu:x},L))),_=[O,f,g,"shiftIds",s,"customerIds",b,p,"kindIds"];i(Object(Z.e)(_,k,N,{}));break;case"ghiChu":case"dieuChinh":i(Object(Z.c)(M,e,N,{}))}}}var le=t(8),re=t(106),ue={};var de={};n.default=Object(r.o)((function(e){var n=e.shiftData,t=e.soMonMan,r=e.isInput,d=e.setIsInput,b=Object(s.a)(),g=Object(s.b)((function(e){return e.diaDiem})),p=g.diaDiemData,O=g.customerId,j=g.yearId,D=g.weekId,y=g.dayId,M=Object(s.b)((function(e){return e.nguyenLieu})).nguyenLieus,E=Object(s.b)((function(e){return e.recipe})).ingreRecipeData,T=Object(s.b)((function(e){return e.thucDonDuTruSetting})),P=T.cauHinhDuTrus,I=T.recipeKinds,N=T.nhomGiaMonAnData,S=Object(s.b)((function(e){return e.thucDonDuTru})),x=null===p||void 0===p?void 0:p.id,w=n.id,A=null===S||void 0===S?void 0:S.isLoading,L=(null===N||void 0===N?void 0:N.giaPhanAn)||0,k=null===S||void 0===S?void 0:S["duTruDatas/".concat(w)],_=null===S||void 0===S?void 0:S["thucDonDatas/".concat(w)],H=null===S||void 0===S?void 0:S["tongHopDuTruData/".concat(O,"/").concat(w)],G=l.a.useMemo((function(){return null===P||void 0===P?void 0:P[w]}),[P,w]),R=Object(c.useState)(!1),U=Object(i.a)(R,2),K=U[0],V=(U[1],Object(c.useState)([])),F=Object(i.a)(V,2),z=F[0],X=F[1];l.a.useEffect((function(){b(Object(Y.d)(x,O))}),[x,O]),l.a.useEffect((function(){var e=[];G&&k&&_&&y&&M&&E&&(e=(e=W.a.reduce((function(e,n){var t=n.id,a=null===G||void 0===G?void 0:G[n.id],i=((null===a||void 0===a?void 0:a.values)||[]).map((function(e){var n,a=null===k||void 0===k?void 0:k[e],o=null===_||void 0===_?void 0:_[e],i=null===o||void 0===o?void 0:o.recipeId,c=(null===a||void 0===a?void 0:a.soPhanAn)||0,l=(null===a||void 0===a?void 0:a.soPhanThem)||0,r=c+l,u=(null===a||void 0===a?void 0:a.ghiChu)||"",d=(null===a||void 0===a?void 0:a.dieuChinh)||{},s=(null===E||void 0===E?void 0:E[i])||[],h=b(Object($.d)({nguyenLieus:s},d,[i])),v=r*h;return{id:"".concat(e),name:(null===I||void 0===I||null===(n=I[e])||void 0===n?void 0:n.name)||e,loaiMonId:t,recipeId:i,tenMon:i,giaMon:h,thanhTien:v,ghiChu:u,soPhanThem:l,soPhanAn:c,tongPhan:r,dieuChinh:d,chiPhiNVL:v}}));return[].concat(Object(o.a)(e),Object(o.a)(i))}),[])).filter((function(e){return e.tenMon}))),X(e)}),[G,k,_,y,M,E]),l.a.useEffect((function(){return b(function(e){return function(n,t){var a=t().diaDiem,i=a.diaDiemData,c=a.yearId,l=a.weekId,r=a.dayId,u=a.customerId,d=[i.id,c,l,"shiftIds",e,"customerIds",u,r,"kindIds"],s=[].concat(Object(o.a)(re.b),d);de[e]=le.a.database().ref(s.join("/")),de[e].on("value",(function(t){var a=t.val()||{};n({type:re.a.GETS_THUC_DON_DU_TRU,payload:Object(te.a)({},"duTruDatas/".concat(e),a)})}))}}(w)),function(){return function(e){(null===de||void 0===de?void 0:de[e])&&de[e].off()}(w)}}),[x,j,D,w,O,y]),l.a.useEffect((function(){return b(function(e){return function(n,t){var a=t().diaDiem,i=a.diaDiemData,c=a.yearId,l=a.weekId,r=a.dayId,u=[i.id,c,l,"shiftIds",e,"thucDons",r,"kindIds"],d=[].concat(Object(o.a)(re.b),u);ue[e]=le.a.database().ref(d.join("/")),ue[e].on("value",(function(t){var a=t.val()||{};n({type:re.a.GETS_THUC_DON_DU_TRU,payload:Object(te.a)({},"thucDonDatas/".concat(e),a)})}))}}(w)),function(){return function(e){(null===ue||void 0===ue?void 0:ue[e])&&ue[e].off()}(w)}}),[x,j,D,w,y]),l.a.useEffect((function(){if(k&&G&&O&&N&&z.length>0){var e=b(ie(k,z,{shiftId:w,soMonMan:t}));b(Object(Z.g)(O,w,e))}else b(Object(Z.g)(O,w,null))}),[O,k,G,N,z]);var J=l.a.useMemo((function(){return new v.a}),[]).getDuTruItemColumns(Object(a.a)(Object(a.a)({},e),{},{setIsInput:d,isInput:r,coSoId:x,customerId:O,shiftId:w,dayId:y,giaPhanAn:L,nhomGiaMonAnDataId:null===N||void 0===N?void 0:N.id,onUpdate:function(e,n){b(ce(e,n,{shiftId:w,soMonMan:t}))}}));return l.a.useMemo((function(){return(z||[]).length>0}),[z])?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row duTruItem mb-3"},l.a.createElement("div",{className:"col-lg-9"},l.a.createElement(h,{shiftData:n,isInput:r,setIsInput:d}),l.a.createElement("div",{className:"mb-2"},l.a.createElement(u.a,{size:"small",loading:A||K,rowKey:"id",bordered:!0,expandAll:!0,pagination:!1,columns:J,dataSource:z,scroll:{x:800},expandable:{expandedRowRender:function(e){return l.a.createElement(ne,{record:e})}},summary:function(e){return l.a.createElement(m,{rowDatas:e})}}))),l.a.createElement("div",{className:"col-lg-3"},l.a.createElement(f,{shiftId:w,dayTongHopData:H}),l.a.createElement(C,{shiftData:n,dayTongHopData:H,dataSource:z}))),l.a.createElement(Q,{shiftData:n,dayTongHopData:H})):l.a.createElement(l.a.Fragment,null)}))}}]);